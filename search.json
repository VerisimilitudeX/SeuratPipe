[{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"SeuratPipe for scRNA-seq analysis","text":"aim SeuratPipe package streamline provide reproducible computational analysis pipeline single cell genomics. aims remove technical details user, enabling wet lab researchers ‘initial look’ data . package publicly available Github https://github.com/andreaskapou/SeuratPipe. vignette show perform different Seurat analyses using SeuratPipe. run contents vignette download data Github repository https://github.com/andreaskapou/SeuratPipe_tutorial data folder.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"seuratpipe-installation","dir":"Articles","previous_headings":"","what":"SeuratPipe installation","title":"SeuratPipe for scRNA-seq analysis","text":"","code":"# install.packages(\"remotes\")  # To install the stable release remotes::install_github(\"andreaskapou/SeuratPipe@release/v1.0.0\")  # To install the latest source version (not recommended) remotes::install_github(\"andreaskapou/SeuratPipe\")"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"scrublet-python-installation","dir":"Articles","previous_headings":"SeuratPipe installation","what":"Scrublet Python installation","title":"SeuratPipe for scRNA-seq analysis","text":"Scrublet method doublet detection, Github page: https://github.com/swolock/scrublet. method implemented Python, hence installing SeuratPipe, Scrublet package installed automatically. can try install run Scrublet within R using reticulate package. wrote helper function ease installation Scrublet. R type: fails, need follow details reticulate package install Python package machine. issues installation, can still use SeuratPipe package, although set use_scrublet = FALSE, .e. perform doublet detection analysis.","code":"SeuratPipe::install_scrublet() # type ?install_scrublet for more details"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"datasets","dir":"Articles","previous_headings":"","what":"Datasets","title":"SeuratPipe for scRNA-seq analysis","text":"Initially, using PBMC3K dataset, show read 10x output files create Seurat objects, perform QC filtering subsequent processing clustering steps. Next, use IFNB dataset, contains two samples (control stimulated cells) perform data integration Harmony. First load required packages","code":"library(Seurat) library(SeuratPipe)"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"running-qc-pipeline","dir":"Articles","previous_headings":"","what":"Running QC pipeline","title":"SeuratPipe for scRNA-seq analysis","text":"SeuratPipe assumes user sample metadata file/data frame contains metadata scRNA-seq sample. also requires following column names present: sample, donor, path, condition pass_qc (logical TRUE FALSE). instance metadata file looks like : Settings QC can perform QC pipeline steps using single wrapper function run_qc_pipeline shown . function also generate QC plots. NOTE: wrapper also store .rds file, named (seu_qc.rds) contains Seurat object opts defined analysis. done reproducibility purposes (see Cluster analysis section read file). template running QC pipeline using SeuratPipe can found : https://github.com/andreaskapou/SeuratPipe_tutorial/blob/main/template_qc_pipeline.R","code":"# Assume 10x data are in 'data' and we have metadata file 'meta_pbmc3k.csv' io <- list() io$data_dir <- \"data/\" io$out_dir <- \"pbmc_results/qc/\" io$tenx_dir <- \"/outs/\" # Assume whole-cell RNA-seq io$meta_file <- paste0(io$data_dir, \"/meta_pbmc3k.csv\")  # Opts opts <- list() opts$nfeat_thresh <- 200 opts$mito_thresh <- 5 opts$meta_colnames <- c(\"donor\", \"condition\", \"pass_qc\") opts$qc_to_plot <- c(\"nFeature_RNA\", \"percent.mito\") # Run pipeline, note you can define additional parameters # type ?run_qc_pipeline for help. seu <- run_qc_pipeline(   data_dir = io$data_dir,    sample_meta = NULL,    sample_meta_filename = io$meta_file,   nfeat_thresh = opts$nfeat_thresh,    mito_thresh = opts$mito_thresh,   meta_colnames = opts$meta_colnames,   out_dir = io$out_dir,   qc_to_plot = opts$qc_to_plot,   use_scrublet = FALSE,    use_soupx = FALSE,    tenx_dir = io$tenx_dir) ## [1] \"Sample  pbmc1 ... \\n\""},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"advanced","dir":"Articles","previous_headings":"Running QC pipeline","what":"Advanced","title":"SeuratPipe for scRNA-seq analysis","text":"want control QC analysis, function wraps following commands generates plots.","code":"# First create Seurat seu <- create_seurat_object(...) # Then perform filtering seu <- filter_seurat_object(...)"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"running-cluster-pipeline","dir":"Articles","previous_headings":"","what":"Running cluster pipeline","title":"SeuratPipe for scRNA-seq analysis","text":"advised different files different analysis tasks, QC clustering. , likely perform QC (two), clustering (downstream tasks) multiple times. reason store QCed Seurat object can read directly disk. SeuratPipe can also define module groups, consisting known marker genes, can help potentially annotating cell populations. show perform common analysis pipeline Seurat cell type identification. wrapper function performs following steps: Data processing, e.g. Log normalisation scaling. Running PCA. Perform UMAP clustering. Generate plots / outputs corresponding directories. NOTE: multiple npcs ndims given input, updated Seurat object last setting returned. template running clustering pipeline using SeuratPipe can found : https://github.com/andreaskapou/SeuratPipe_tutorial/blob/main/template_cluster_pipeline.R","code":"# Define again I/O and opts settings io <- list() io$base_dir <- \"pbmc_results/\" io$out_dir <- paste0(io$base_dir, \"/cluster/\") # Read Seurat object stored after QC seu_obj <- readRDS(file = paste0(io$base_dir, \"/qc/seu_qc.rds\")) seu <- seu_obj$seu   # Extract Seurat object opts <- seu_obj$opts # Extract opts from QC (for reproducibility)  # Clustering opts  # Number of PCs, can be a vector: c(30, 50) opts$npcs <- c(30) # PCs to perform UMAP and clustering, e.g c(30, 40) opts$ndims <- c(25) # Clustering resolutions opts$res <- seq(from = 0.2, to = 0.2, by = 0.1) # QC information to plot opts$qc_to_plot <- c(\"nFeature_RNA\", \"percent.mito\") # Metadata columns to plot opts$meta_to_plot <- c(\"condition\", \"sample\") # Maximum cutoff values for plotting continuous features opts$max.cutoff <- \"q98\" # Define modules for lineage and cell cycle lineage <- list(lin_CD4 = c(\"IL7R\", \"CCR7\"),                 lin_Monocyte = c(\"CD14\", \"LYZ\", \"FCGR3A\"),                 lin_NK = c(\"GNLY\", \"NKG7\")) # Take a random subset from Seurat's cycle genes cell_cycle <- list(cc_s = c(\"PCNA\", \"RRM1\", \"POLA1\", \"USP1\"),                    cc_g2m = c(\"HMGB2\", \"MKI67\", \"TMPO\", \"CTCF\"))  # Group all modules in named list to pass to SeuratPipe functions opts$modules_group <- list(lineage = lineage,                            cell_cycle = cell_cycle) # Run pipeline, note you can define additional parameters # type ?run_cluster_pipeline for help. seu <- run_cluster_pipeline(   seu_obj = seu,    out_dir = io$out_dir,    npcs = opts$npcs,   ndims = opts$ndims,    res = opts$res,   modules_group = opts$modules_group,   metadata_to_plot = opts$meta_to_plot,   qc_to_plot = opts$qc_to_plot,    max.cutoff = opts$max.cutoff,   pcs_to_remove = NULL, seed = 1) ## Res 0.2  ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck ##  ## Number of nodes: 2642 ## Number of edges: 127025 ##  ## Running Louvain algorithm... ## Maximum modularity in 10 random starts: 0.9328 ## Number of communities: 6 ## Elapsed time: 0 seconds"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"advanced-1","dir":"Articles","previous_headings":"Running cluster pipeline","what":"Advanced","title":"SeuratPipe for scRNA-seq analysis","text":"want control clustering pipeline, function wraps following functions. code works single choice npcs ndims whereas wrapper function allows multiple values passed vector. Users can even control cluster_analysis, main functions perform clustering following: Note naming convention use exactly function names Seurat package, using underscores instead CamelCase, default Seurat. holds plotting functions (see examples next section). case list Seurat objects wanted perform clustering analysis sample independently, code look something like :","code":"# Process and PCA seu <- lognormalize_and_pca(...) # UMAP seu <- run_umap(...) # QC plots on dimensional reduced space dimred_qc_plots(...) # Module score analysis seu <- module_score_analysis(...) # Clustering seu <- cluster_analysis(...) # Find neighbors seu <- find_neighbors(...) # Clustering with specific resolution seu <- find_clusters(...) # Identify marker genes markers <- find_all_markers(...) for (s in names(seu)) {   sample_dir <- paste0(io$out_dir, \"/\", s, \"/\")   seu[[s]] <- run_cluster_pipeline(...) }"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"plotting-visualisation","dir":"Articles","previous_headings":"Running cluster pipeline","what":"Plotting / Visualisation","title":"SeuratPipe for scRNA-seq analysis","text":"SeuratPipe also provides tailored functions generate high quality plots, adapting Seurat’s built plotting functions. plot chunk sp-cl-fig1 plot chunk sp-cl-fig2 plot chunk sp-cl-fig3 plot chunk sp-cl-fig4 plot chunk sp-cl-fig5 can also check specific technical factors correlated specific principal components. plot chunk sp-cl-fig7 plot can also useful understand specific principal components explain/capture information different cell types/lineages. plot chunk sp-cl-fig8","code":"# UMAP plot dim_plot(seu, reduction = \"umap\", group.by = \"seurat_clusters\", pt.size = 2) # UMAP plot using SeuratPipe colour palette dim_plot(seu, reduction = \"umap\", group.by = \"seurat_clusters\",           col_pal = SeuratPipe:::discrete_col_pal, pt.size = 2) # Plotting specific genes feature_plot(seu, features = c(\"LYZ\", \"NKG7\"),               ncol = 2, legend.position = \"top\") # Plotting lineage module scores as feature plot feature_plot(seu, features = names(lineage), ncol = 3) & NoAxes() # Plotting lineage module scores as dot plot dot_plot(seu, features = names(lineage)) pca_feature_cor_plot(seu, features = c(\"nFeature_RNA\", \"percent.mito\")) # Correlation of lineage scores with PCs pca_feature_cor_plot(seu, features = names(lineage))"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"harmony-integration","dir":"Articles","previous_headings":"","what":"Harmony integration","title":"SeuratPipe for scRNA-seq analysis","text":"showcase pipeline Harmony integration first load pre-processed Seurat immune dataset called ifnb. object format run QC code run_qc_pipeline.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"reading-seurat-object-and-defining-settings-for-harmony-pipeline-","dir":"Articles","previous_headings":"Harmony integration","what":"Reading Seurat object and defining settings for Harmony pipeline.","title":"SeuratPipe for scRNA-seq analysis","text":"Note parameters almost identical run_cluster_pipeline, minor differences, run_harmony_pipeline can accept list Seurat objects (.e. multiple samples), internally processes merges data. already merged processed data, pipeline accepts single Seurat object skip merging step. Next ready perform full Harmony integration pipeline obtain final clusters. template running Harmony integration pipeline using SeuratPipe can found : https://github.com/andreaskapou/SeuratPipe_tutorial/blob/main/template_harmony_pipeline.R","code":"# I/O io <- list() io$base_dir <- \"ifnb_results/\" io$out_dir <- paste0(io$base_dir, \"/integrate/\") # Read QCed Seurat object seu_obj <- readRDS(file = paste0(io$base_dir, \"/qc/seu_qc.rds\")) seu <- seu_obj$seu   # Extract (list of) Seurat objects opts <- seu_obj$opts # Extract opts from QC (here empty list)  # Clustering opts  # Number of PCs opts$npcs <- c(50) # Harmony dims for UMAP and clustering opts$ndims <- c(40) # Clustering resolutions opts$res <- seq(0.1, 0.1, by = 0.1) # Batch ID to perform integration opts$batch_id <- \"sample\" # QC information to plot opts$qc_to_plot <- c(\"nFeature_RNA\", \"percent.mito\") # Metadata columns to plot opts$meta_to_plot <- c(\"condition\") # Maximum number of Harmony iterations opts$max.iter.harmony <- 50 # Run pipeline, note you can define additional parameters # type ?run_harmony_pipeline for help. seu <- run_harmony_pipeline(   seu_obj = seu,    batch_id = opts$batch_id,   out_dir = io$out_dir,    npcs = opts$npcs,   ndims = opts$ndims,    res = opts$res, modules_group = NULL,    metadata_to_plot = opts$meta_to_plot,   max.iter.harmony = opts$max.iter.harmony,   qc_to_plot = opts$qc_to_plot,    plot_cluster_markers = FALSE, seed = 1) ## Res 0.1  ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck ##  ## Number of nodes: 13999 ## Number of edges: 548086 ##  ## Running Louvain algorithm... ## Maximum modularity in 10 random starts: 0.9674 ## Number of communities: 9 ## Elapsed time: 1 seconds"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"advanced-2","dir":"Articles","previous_headings":"Harmony integration","what":"Advanced","title":"SeuratPipe for scRNA-seq analysis","text":"want control Harmony integration pipeline, function wraps following functions. code works single choice npcs ndims whereas wrapper function allows multiple values passed vector.","code":"# Harmony analysis seu <- harmony_analysis(...) # UMAP seu <- run_umap(...) # QC plots on dimensional reduced space dimred_qc_plots(...) # Module score analysis seu <- module_score_analysis(...) # Clustering seu <- cluster_analysis(...)"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"visualistion","dir":"Articles","previous_headings":"Harmony integration","what":"Visualistion","title":"SeuratPipe for scRNA-seq analysis","text":"plot chunk sp-har-fig1 plot chunk sp-har-fig2 plot chunk sp-har-fig3","code":"dim_plot(seu, group.by = \"seurat_clusters\", pt.size = 2,          col_pal = SeuratPipe:::discrete_col_pal) & NoAxes() dim_plot(seu, group.by = \"condition\", split.by = \"condition\", ncol = 2) # Plotting specific genes feature_plot(seu, features = c(\"LYZ\", \"NKG7\"),               ncol = 2, legend.position = \"top\")"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"SeuratPipe for scRNA-seq analysis","text":"vignette compiled using following packages:","code":"sessionInfo() ## R version 4.2.0 (2022-04-22) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Big Sur/Monterey 10.16 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib ##  ## locale: ## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8 ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] SeuratPipe_1.0.0   sp_1.4-7           SeuratObject_4.1.0 Seurat_4.1.1       ## [5] BiocStyle_2.24.0   ##  ## loaded via a namespace (and not attached): ##   [1] Rtsne_0.16            colorspace_2.0-3      deldir_1.0-6          ##   [4] ellipsis_0.3.2        ggridges_0.5.3        spatstat.data_2.2-0   ##   [7] farver_2.1.0          leiden_0.4.2          listenv_0.8.0         ##  [10] ggrepel_0.9.1         RSpectra_0.16-1       fansi_1.0.3           ##  [13] codetools_0.2-18      splines_4.2.0         knitr_1.39            ##  [16] polyclip_1.10-0       jsonlite_1.8.0        ica_1.0-2             ##  [19] cluster_2.1.3         png_0.1-7             rgeos_0.5-9           ##  [22] pheatmap_1.0.12       uwot_0.1.11           shiny_1.7.1           ##  [25] sctransform_0.3.3     spatstat.sparse_2.1-1 BiocManager_1.30.18   ##  [28] compiler_4.2.0        httr_1.4.3            assertthat_0.2.1      ##  [31] Matrix_1.4-1          fastmap_1.1.0         lazyeval_0.2.2        ##  [34] limma_3.52.1          cli_3.3.0             later_1.3.0           ##  [37] htmltools_0.5.2       tools_4.2.0           igraph_1.3.1          ##  [40] gtable_0.3.0          glue_1.6.2            RANN_2.6.1            ##  [43] reshape2_1.4.4        dplyr_1.0.9           Rcpp_1.0.8.3          ##  [46] scattermore_0.8       vctrs_0.4.1           nlme_3.1-157          ##  [49] progressr_0.10.0      lmtest_0.9-40         spatstat.random_2.2-0 ##  [52] xfun_0.31             stringr_1.4.0         globals_0.15.0        ##  [55] mime_0.12             miniUI_0.1.1.1        lifecycle_1.0.1       ##  [58] irlba_2.3.5           gtools_3.9.2          goftest_1.2-3         ##  [61] future_1.25.0         MASS_7.3-57           zoo_1.8-10            ##  [64] scales_1.2.0          spatstat.core_2.4-4   promises_1.2.0.1      ##  [67] spatstat.utils_2.3-1  parallel_4.2.0        RColorBrewer_1.1-3    ##  [70] yaml_2.3.5            reticulate_1.25       pbapply_1.5-0         ##  [73] gridExtra_2.3         ggplot2_3.3.6         rpart_4.1.16          ##  [76] stringi_1.7.6         highr_0.9             harmony_0.1.0         ##  [79] rlang_1.0.2           pkgconfig_2.0.3       matrixStats_0.62.0    ##  [82] evaluate_0.15         lattice_0.20-45       ROCR_1.0-11           ##  [85] purrr_0.3.4           tensor_1.5            labeling_0.4.2        ##  [88] patchwork_1.1.1       htmlwidgets_1.5.4     cowplot_1.1.1         ##  [91] tidyselect_1.1.2      parallelly_1.31.1     RcppAnnoy_0.0.19      ##  [94] plyr_1.8.7            magrittr_2.0.3        R6_2.5.1              ##  [97] generics_0.1.2        DBI_1.1.2             withr_2.5.0           ## [100] mgcv_1.8-40           pillar_1.7.0          fitdistrplus_1.1-8    ## [103] survival_3.3-1        abind_1.4-5           tibble_3.1.7          ## [106] future.apply_1.9.0    crayon_1.5.1          KernSmooth_2.23-20    ## [109] utf8_1.2.2            spatstat.geom_2.4-0   plotly_4.10.0         ## [112] rmarkdown_2.14        viridis_0.6.2         grid_4.2.0            ## [115] data.table_1.14.2     digest_0.6.29         xtable_1.8-4          ## [118] tidyr_1.2.0           httpuv_1.6.5          munsell_0.5.0         ## [121] viridisLite_0.4.0"},{"path":"https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html","id":"acknowledgments","dir":"Articles","previous_headings":"","what":"Acknowledgments","title":"SeuratPipe for scRNA-seq analysis","text":"like thank John Wilson-Kanamori, Jordan Portman Nick Younger. SeuratPipe package adapted many analyses pipelines developed computational biology group Neil Henderson’s lab University Edinburgh. package supported funding University Edinburgh Medical Research Council (core grant MRC Institute Genetics Cancer) Cross-Disciplinary Fellowship (XDF) programme.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Andreas C. Kapourani. Author, maintainer.","code":""},{"path":[]},{"path":"https://andreaskapou.github.io/SeuratPipe/index.html","id":"seuratpipe","dir":"","previous_headings":"","what":"Packaging common Seurat analysis tasks","title":"Packaging common Seurat analysis tasks","text":"aim SeuratPipe package streamline provide reproducible computational analysis pipeline single cell genomics. aims remove technical details user, enabling wet lab researchers ‘initial look’ data . package publicly available Github https://github.com/andreaskapou/SeuratPipe. vignette demonstrating use SeuratPipe scRNA-seq analysis can found https://andreaskapou.github.io/SeuratPipe/articles/SeuratPipe.html data can downloaded Github repository https://github.com/andreaskapou/SeuratPipe_tutorial. Templates R code running QC, clustering data integration pipelines can found https://github.com/andreaskapou/SeuratPipe_tutorial Github repository.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Packaging common Seurat analysis tasks","text":"","code":"# install.packages(\"remotes\")  # To install the stable release remotes::install_github(\"andreaskapou/SeuratPipe@release/v1.0.0\")  # To install the latest source version (not recommended) remotes::install_github(\"andreaskapou/SeuratPipe\")"},{"path":"https://andreaskapou.github.io/SeuratPipe/index.html","id":"scrublet-python-installation","dir":"","previous_headings":"Installation","what":"Scrublet Python installation","title":"Packaging common Seurat analysis tasks","text":"Scrublet method doublet detection, Github page: https://github.com/swolock/scrublet. method implemented Python, hence installing SeuratPipe, Scrublet package installed automatically. can try install run Scrublet within R using reticulate package. wrote helper function ease installation Scrublet. R type: issues installation, can still use SeuratPipe package, although set use_scrublet = FALSE, .e. perform doublet detection analysis.","code":"SeuratPipe::install_scrublet() # type ?install_scrublet for more details"},{"path":"https://andreaskapou.github.io/SeuratPipe/index.html","id":"qc-analysis-pipeline","dir":"","previous_headings":"","what":"QC analysis pipeline","title":"Packaging common Seurat analysis tasks","text":"SeuratPipe assumes user sample metadata file/data frame contains metadata scRNA-seq sample. also requires following column names present: sample, donor, path, condition pass_qc (logical TRUE FALSE). can perform QC pipeline steps using single wrapper function run_qc_pipeline shown . function also generate required QC plots.","code":"seu <- run_qc_pipeline(...) # type ?run_qc_pipeline for argument details"},{"path":"https://andreaskapou.github.io/SeuratPipe/index.html","id":"clustering-analysis-pipeline","dir":"","previous_headings":"","what":"Clustering analysis pipeline","title":"Packaging common Seurat analysis tasks","text":"show perform common analysis pipeline Seurat cell type identification. wrapper function performs following steps: Data processing, e.g. Log normalisation scaling. Run PCA. Perform UMAP clustering. Generate plots / outputs corresponding directories.","code":"seu <- run_cluster_pipeline(...) # type ?run_cluster_pipeline for argument details"},{"path":"https://andreaskapou.github.io/SeuratPipe/index.html","id":"harmony-integration-pipeline","dir":"","previous_headings":"","what":"Harmony integration pipeline","title":"Packaging common Seurat analysis tasks","text":"Harmony integration pipeline almost identical run_cluster_pipeline, main difference function accepting list Seurat objects (containing information single sample) perform data integration.","code":"seu <- run_harmony_pipeline(...) # type ?run_harmony_pipeline for argument details"},{"path":"https://andreaskapou.github.io/SeuratPipe/index.html","id":"acknowledgments","dir":"","previous_headings":"","what":"Acknowledgments","title":"Packaging common Seurat analysis tasks","text":"like thank John Wilson-Kanamori, Jordan Portman Nick Younger. SeuratPipe package adapted many analyses pipelines developed computational biology group Neil Henderson’s lab University Edinburgh. package supported funding University Edinburgh Medical Research Council (core grant MRC Institute Genetics Cancer) Cross-Disciplinary Fellowship (XDF) programme.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/SeuratPipe.html","id":null,"dir":"Reference","previous_headings":"","what":"SeuratPipe: Streamlining Seurat analysis — SeuratPipe","title":"SeuratPipe: Streamlining Seurat analysis — SeuratPipe","text":"SeuratPipe contains common analysis, processing plotting functions attempt streamline single-cell genomics analysis using Seurat package.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/SeuratPipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SeuratPipe: Streamlining Seurat analysis — SeuratPipe","text":"SeuratPipe main package documentation.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/SeuratPipe.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"SeuratPipe: Streamlining Seurat analysis — SeuratPipe","text":"C..Kapourani kapouranis.andreas@gmail.com","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/add_umap_embedding.html","id":null,"dir":"Reference","previous_headings":"","what":"Add UMAP embedding in Seurat object — add_umap_embedding","title":"Add UMAP embedding in Seurat object — add_umap_embedding","text":"Add UMAP embedding existing Seurat object. case running pipeline want attach stored UMAP embedding, stored CSV file, instead recomputing UMAP.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/add_umap_embedding.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add UMAP embedding in Seurat object — add_umap_embedding","text":"","code":"add_umap_embedding(seu, embedding)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/add_umap_embedding.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add UMAP embedding in Seurat object — add_umap_embedding","text":"seu Seurat object embedding UMAP embedding. character, function assume filename given read corresponding UMAP embedding. Otherwise, assumes UMAP embedding matrix provided input containing embeddings columns.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/cluster_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Common clustering analysis steps — cluster_analysis","title":"Common clustering analysis steps — cluster_analysis","text":"function implements analysis steps performing clustering Seurat object. include, 1. finding neighbours lower dimensional space (defined 'cluster_reduction' parameter) 2. obtaining clusters, 3. identifying marker genes (NOTE: speed re-analysis first checks file marker genes already present, yes reads file instead calling FinaAllMarkers) 4. generating plots, include heatmap (scaled) expression marker genes cluster, marker gene expression feature plots (e.g. UMAP space, defined plot_reduction'  parameter), dot / feature plots pre-computed module scores cluster (assumes first run 'module_score_analysis' function). step useful lineage annotation.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/cluster_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Common clustering analysis steps — cluster_analysis","text":"","code":"cluster_analysis(   seu,   dims = 1:20,   res = seq(0.1, 0.1, by = 0.1),   logfc.threshold = 0.5,   min.pct = 0.25,   only.pos = TRUE,   topn_genes = 10,   diff_cluster_pct = 0.1,   pval_adj = 0.05,   plot_dir = NULL,   plot_cluster_markers = TRUE,   modules_group = NULL,   cluster_reduction = \"pca\",   plot_reduction = \"umap\",   max.cutoff = \"q98\",   min.cutoff = NA,   seed = 1,   force_reanalysis = TRUE,   label = TRUE,   label.size = 8,   legend.position = \"right\",   pt.size = 1.4,   cont_col_pal = NULL,   discrete_col_pal = NULL,   fig.res = 200,   heatmap_downsample_cols = NULL,   cont_alpha = c(0.1, 0.9),   discrete_alpha = 0.9,   pt.size.factor = 1.1,   spatial_col_pal = \"inferno\",   crop = FALSE,   plot_spatial_markers = FALSE,   spatial_legend_position = \"top\",   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/cluster_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Common clustering analysis steps — cluster_analysis","text":"seu Seurat object (required). dims Vector denoting dimensions use nearest neighnors clustering ('cluster_reduction' parameter ). res Vector clustering resolutions (e.g. seq(0.1, 0.6, = 0.1)). logfc.threshold Limit testing genes show, average, least X-fold difference (log-scale) two groups cells. min.pct test genes detected minimum fraction min.pct cells either two populations. .pos return positive markers (TRUE default). topn_genes Top cluster marker genes use plot (heatmap feature plots), default 10. diff_cluster_pct Retain marker genes per cluster pct.1 - pct.2 > diff_cluster_pct, .e. show cluster specific expression. Set -Inf, ignore additional filtering. pval_adj Adjusted p-value threshold consider marker genes per cluster. plot_dir Directory save generated plots. NULL, plots saved. plot_cluster_markers Logical, whether create feature plots 'topn_genes' cluster markers. Added mostly reduce number files (size) analysis folders. Default TRUE. modules_group Group modules (named list lists) storing features (e.g. genes) compute module score identified cluster. step can useful annotating different clusters saving dot plots group. Assumes already computed modules e.g. calling 'module_score_analysis' function. 'plot_dir' NULL, plots generated. cluster_reduction Dimensionality reduction use performing clustering. Default 'pca', set 'harmony' perform data integration. plot_reduction Dimensionality reduction use plotting functions. Default 'umap'. max.cutoff Vector maximum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Vector minimum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). seed Set random seed, reproducibility. force_reanalysis Logical, cluster marker genes file exists force_reanalysis = FALSE, run identification cluster markers. Otherwise, read cluster markers file. Added computing time efficiency purposes. label Whether label clusters 'plot_reduction' space. label.size Sets size labels. legend.position Position legend, default \"right\" (set \"none\" clean plot). pt.size Adjust point size plotting. cont_col_pal Continuous colour palette use, default \"RdYlBu\". discrete_col_pal Discrete colour palette use, default Hue palette (hue_pal) 'scales' package. fig.res Figure resolution ppi (see 'png' function). heatmap_downsample_cols numeric, downsample columns heatmap plot, large specific cluster dominate heatmap. cont_alpha (Spatial) Controls opacity spots. Provide vector specifying min max range values (0 1). discrete_alpha (Spatial) Controls opacity spots. Provide single alpha value. pt.size.factor (Spatial) Scale size spots. spatial_col_pal (Spatial) Continuous colour palette use viridis package colour spots tissue, default \"inferno\". crop (Spatial) Crop plot focus spots passed QC. Set FALSE show entire background image. plot_spatial_markers (Spatial) Logical, whether create spatial feature plots expression individual genes. spatial_legend_position (Spatial) Position legend spatial plots, default \"top\" (set \"none\" clean plot). ... Additional named parameters passed Seurat analysis plotting functions, FindClusters, FindAllMarkers, DimPlot FeaturePlot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/cluster_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Common clustering analysis steps — cluster_analysis","text":"Updated Seurat object clustered cells","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/cluster_analysis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Common clustering analysis steps — cluster_analysis","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/compute_module_score.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored module score calculation — compute_module_score","title":"Tailored module score calculation — compute_module_score","text":"function adapts AddModuleScore Seurat function compute module scores based group genes interest.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/compute_module_score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored module score calculation — compute_module_score","text":"","code":"compute_module_score(seu, features, name, seed = 1, ...)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/compute_module_score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored module score calculation — compute_module_score","text":"seu Seurat object (required). features Vector features (e.g. genes) compute module score. name Name module score stored metadata slot. seed Set random seed, reproducibility. ... Additional parameters passed Seurat's AddModuleScore.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/compute_module_score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored module score calculation — compute_module_score","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/compute_module_score.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored module score calculation — compute_module_score","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/create_seurat_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Seurat object based on sample metadata. — create_seurat_object","title":"Create Seurat object based on sample metadata. — create_seurat_object","text":"function creates Seurat object sample metadata file. also allows user perform SoupX (ambient RNA removal) Scrublet (doublet detection) analysis.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/create_seurat_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Seurat object based on sample metadata. — create_seurat_object","text":"","code":"create_seurat_object(   data_dir,   sample_meta = NULL,   sample_meta_filename = NULL,   meta_colnames = c(\"donor\", \"condition\", \"pass_qc\"),   plot_dir = NULL,   use_scrublet = TRUE,   use_soupx = FALSE,   tenx_dir = \"premrna_outs\",   tenx_counts_dir = \"filtered_feature_bc_matrix\",   expected_doublet_rate = 0.06,   min.cells = 10,   min.features = 200,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/create_seurat_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Seurat object based on sample metadata. — create_seurat_object","text":"data_dir Parent directory sample 10x files stored. Think project directory. sample_meta Sample metadata information Data.frame like object. Columns least contain 'sample', 'donor', 'condition' 'pass_qc'. sample_meta_filename Filename sample metadata information, 'meta' parameter . User provide one 'meta' 'meta_filename'. meta_colnames Sample metadata column names store Seurat metadata. plot_dir Directory storing QC plots. Used use_soupx = TRUE. use_scrublet Logical, wether use Scrublet doublet detection. use_soupx Logical, wether use SoupX ambient RNA removal. tenx_dir Name 10x base directory, e.g. outputs running cellranger. Default 'premrna_outs', .e. assumes single-nuclei RNA-seq. tenx_counts_dir Name 10x directory count matrices stored. Default 'filtered_feature_bc_matrix' expected_doublet_rate expected fraction transcriptomes doublets, typically 0.05 - 0.1 min.cells Include features/genes detected least many cells. min.features Include cells least many features/genes detected. ... Additional named parameters passed Seurat, Scrublet SoupX.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/create_seurat_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Seurat object based on sample metadata. — create_seurat_object","text":"List Seurat objects equal number samples sample metadata file. single sample, returns Seurat object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/create_seurat_object.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create Seurat object based on sample metadata. — create_seurat_object","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored dimensional reduction plot — dim_plot","title":"Tailored dimensional reduction plot — dim_plot","text":"function extends DimPlot Seurat function providing additional plotting options.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored dimensional reduction plot — dim_plot","text":"","code":"dim_plot(   seu,   reduction = \"umap\",   group.by = \"active.ident\",   split.by = NULL,   ncol = NULL,   legend.position = \"right\",   col_pal = NULL,   dims_plot = c(1, 2),   pt.size = 1.4,   label = FALSE,   label.size = 7,   combine = TRUE,   pt.shape = 21,   pt.stroke = 0.05,   pt.alpha = 1,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored dimensional reduction plot — dim_plot","text":"seu Seurat object (required). reduction dimensionality reduction use (required). group.Name metadata column group (color) cells (required). split.Name metadata column split plot . ncol Number columns display combining plots. legend.position Position legend, default \"right\" (set \"none\" clean plot). col_pal Discrete colour palette use, default Hue palette (hue_pal) 'scales' package. equal length number groups 'group.'. dims_plot Dimensions plot, must two-length numeric vector specifying x- y-dimensions. pt.size Adjust point size plotting. label Whether label clusters 'plot_reduction' space. label.size Sets size labels. combine Combine plots single patchworked ggplot object. FALSE, return list ggplot objects pt.shape Adjust point shape plotting. pt.stroke Stroke value point. pt.alpha Adjust alpha value point. ... Additional parameters passed Seurat's DimPlot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored dimensional reduction plot — dim_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored dimensional reduction plot — dim_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot_tailored.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored dim plot — dim_plot_tailored","title":"Tailored dim plot — dim_plot_tailored","text":"function generates plot dim_plot, although focuses single group generates slightly better looking plot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot_tailored.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored dim plot — dim_plot_tailored","text":"","code":"dim_plot_tailored(   seu,   group.by,   reduction = \"umap\",   legend.position = \"right\",   col_pal = NULL,   label = FALSE,   label.size = 7,   pt.size = 1.4,   pt.shape = 21,   pt.stroke = 0.05,   pt.alpha = 1,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot_tailored.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored dim plot — dim_plot_tailored","text":"seu Seurat object group.Name metadata column group (color) cells (required). reduction Dimensionality reduction use. legend.position Position legend, default \"right\" (set \"none\" clean plot). col_pal Continuous colour palette use, default \"RdYlBu\". label Whether label groups 'reduction' space. label.size Sets size labels. pt.size Adjust point size plotting. pt.shape Adjust point shape plotting. pt.stroke Stroke value point. pt.alpha Adjust alpha value point. ... Additional parameters passed ggplot2::geom_point.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot_tailored.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored dim plot — dim_plot_tailored","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dim_plot_tailored.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored dim plot — dim_plot_tailored","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dimred_qc_plots.html","id":null,"dir":"Reference","previous_headings":"","what":"QC and general metadata plots visualised on dimensional reduced space — dimred_qc_plots","title":"QC and general metadata plots visualised on dimensional reduced space — dimred_qc_plots","text":"function generates QC general metadata plots visualised dimensional reduced space (e.g. PCA UMAP). aim visualise weather technical factors driving variability data, e.g. integration driven sample, correlation specific PCs number genes expressed cell, etc.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dimred_qc_plots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"QC and general metadata plots visualised on dimensional reduced space — dimred_qc_plots","text":"","code":"dimred_qc_plots(   seu,   reductions = c(\"pca\"),   metadata_to_plot = NULL,   qc_to_plot = NULL,   plot_dir,   max.cutoff = \"q98\",   min.cutoff = NA,   legend.position = \"right\",   cont_col_pal = NULL,   discrete_col_pal = NULL,   dims_plot = c(1, 2),   pt.size = 1.4,   fig.res = 200,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dimred_qc_plots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"QC and general metadata plots visualised on dimensional reduced space — dimred_qc_plots","text":"seu Seurat object (required). reductions Vector dimensional reductions objects use plotting metadata QC features. metadata_to_plot Vector metadata names plot, present  meta.data slot. qc_to_plot Vector QC names plot, present  meta.data slot. plot_dir Directory save generated plots. NULL, plots saved. max.cutoff Vector maximum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Vector minimum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). legend.position Position legend, default \"right\" (set \"none\" clean plot). cont_col_pal Continuous colour palette use, default \"RdYlBu\". discrete_col_pal Discrete colour palette use, default Hue palette (hue_pal) 'scales' package. dims_plot Dimensions plot. UMAP TSNE set c(1,2). pt.size Adjust point size plotting. fig.res Figure resolution ppi (see 'png' function). ... Additional named parameters passed Seurat's DimPlot FeaturePlot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dimred_qc_plots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"QC and general metadata plots visualised on dimensional reduced space — dimred_qc_plots","text":"Nothing, plots saved specified folder NULL.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dimred_qc_plots.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"QC and general metadata plots visualised on dimensional reduced space — dimred_qc_plots","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dot_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored dot plot — dot_plot","title":"Tailored dot plot — dot_plot","text":"function adapts DotPlot Seurat function providing additional plotting options.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dot_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored dot plot — dot_plot","text":"","code":"dot_plot(   seu,   features,   group.by = NULL,   labels = NULL,   xlab = \"Signature\",   ylab = \"Cluster\",   legend.position = \"right\",   col_pal = NULL,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dot_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored dot plot — dot_plot","text":"seu Seurat object (required). features Vector features plot. group.Name metadata column group cells (required). labels want different labels plotted feature. xlab Label x-axis. ylab Label y-axis. legend.position Position legend, default \"right\" (set \"none\" clean plot). col_pal Continuous colour palette use, default \"RdYlBu\". ... Additional parameters passed Seurat's DotPlot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dot_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored dot plot — dot_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/dot_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored dot plot — dot_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored feature plot — feature_plot","title":"Tailored feature plot — feature_plot","text":"function adapts FeaturePlot Seurat function providing additional plotting options.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored feature plot — feature_plot","text":"","code":"feature_plot(   seu,   reduction = \"umap\",   features = \"nFeature_RNA\",   max.cutoff = \"q98\",   min.cutoff = NA,   ncol = NULL,   legend.position = \"right\",   col_pal = NULL,   dims_plot = c(1, 2),   pt.size = 1.4,   combine = TRUE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored feature plot — feature_plot","text":"seu Seurat object (required). reduction dimensionality reduction use (required). features Vector features plot. max.cutoff Vector maximum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Vector minimum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). ncol Number columns display multiple features. legend.position Position legend, default \"right\" (set \"none\" clean plot). col_pal Continuous colour palette use, default \"RdYlBu\". dims_plot Dimensions plot, must two-length numeric vector specifying x- y-dimensions. pt.size Adjust point size plotting. combine Combine plots single patchworked ggplot object. FALSE, return list ggplot objects ... Additional parameters passed Seurat's FeaturePlot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored feature plot — feature_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored feature plot — feature_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot_tailored.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored feature plot — feature_plot_tailored","title":"Tailored feature plot — feature_plot_tailored","text":"function generates plot feature_plot, although focuses single feature generates slightly better looking plot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot_tailored.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored feature plot — feature_plot_tailored","text":"","code":"feature_plot_tailored(   seu,   feature,   max.cutoff = \"q98\",   min.cutoff = NA,   reduction = \"umap\",   slot = \"data\",   col_pal = NULL,   legend.position = \"right\",   pt.size = 2,   pt.shape = 21,   pt.stroke = 0.05,   pt.alpha = 1,   order_points_by_value = TRUE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot_tailored.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored feature plot — feature_plot_tailored","text":"seu Seurat object feature Feature plot. max.cutoff Maximum cutoff value feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Minimum cutoff value feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). reduction Dimensionality reduction use. slot Slot extract data . col_pal Continuous colour palette use, default \"RdYlBu\". legend.position Position legend, default \"right\" (set \"none\" clean plot). pt.size Adjust point size plotting. pt.shape Adjust point shape plotting. pt.stroke Stroke value point. pt.alpha Adjust alpha value point. order_points_by_value Logical, points ordered value (e.g. expression levels), corresponds plotting top cells high expression, instead getting 'buried' lowly expressed cells. ... Additional parameters passed ggplot2::geom_point.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot_tailored.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored feature plot — feature_plot_tailored","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/feature_plot_tailored.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored feature plot — feature_plot_tailored","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_all_markers.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper FindAllMarkers function — find_all_markers","title":"Wrapper FindAllMarkers function — find_all_markers","text":"function just calls Seurat FindAllMarkers function. Used naming consistency package.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_all_markers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper FindAllMarkers function — find_all_markers","text":"","code":"find_all_markers(seu, random.seed = 1, ...)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_all_markers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper FindAllMarkers function — find_all_markers","text":"seu Seurat object (required). random.seed Seed use reproducibility purposes. ... Additional named parameters Seurat FindAllMarkers function.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_all_markers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper FindAllMarkers function — find_all_markers","text":"Data frame marker genes cluster associated statistics.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_all_markers.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Wrapper FindAllMarkers function — find_all_markers","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper FindClusters function — find_clusters","title":"Wrapper FindClusters function — find_clusters","text":"function just calls Seurat FindClusters function. Used naming consistency package.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper FindClusters function — find_clusters","text":"","code":"find_clusters(seu, resolution, random.seed = 1, ...)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper FindClusters function — find_clusters","text":"seu Seurat object (required). resolution Value resolution parameter, use value () 1.0 want obtain larger (smaller) number communities. random.seed Seed use reproducibility purposes. ... Additional named parameters Seurat FindClusters function.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper FindClusters function — find_clusters","text":"Seurat object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_clusters.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Wrapper FindClusters function — find_clusters","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_neighbors.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored function for finding neighbors in lower dimensional space. — find_neighbors","title":"Tailored function for finding neighbors in lower dimensional space. — find_neighbors","text":"function adapts Seurat FindNeighbors function also checking 'dims' larger dimensions 'reduction' object. yes, takes maximum columns 'reduction' object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_neighbors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored function for finding neighbors in lower dimensional space. — find_neighbors","text":"","code":"find_neighbors(seu, dims, reduction, ...)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_neighbors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored function for finding neighbors in lower dimensional space. — find_neighbors","text":"seu Seurat object (required). dims Vector denoting dimensions use input features, e.g. dims = 1:30 reduction Reduction object run UMAP. E.g. can 'pca' 'harmony' integrated data (required). ... Additional named parameters Seurat FindNeighbors function.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_neighbors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored function for finding neighbors in lower dimensional space. — find_neighbors","text":"Seurat object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/find_neighbors.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored function for finding neighbors in lower dimensional space. — find_neighbors","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/harmony_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Analysis steps for Harmony integration — harmony_analysis","title":"Analysis steps for Harmony integration — harmony_analysis","text":"function implements analysis steps performing Harmony integration Seurat object. include, 1. merge samples single Seurat object (list Seurat objects provided) 2. data normalisation, 3. identification HVGs, 4. Scaling expression values computing PCA, 5. running Harmony integration, 8. Generating plots.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/harmony_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analysis steps for Harmony integration — harmony_analysis","text":"","code":"harmony_analysis(   seu,   batch_id = \"sample\",   npcs,   dims.use = NULL,   plot_dir = NULL,   n_hvgs = 3000,   max.iter.harmony = 50,   seed = 1,   fig.res = 200,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/harmony_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analysis steps for Harmony integration — harmony_analysis","text":"seu Seurat object (required). batch_id Name batch try remove data integration (required). Can also vector multiple batch information present. column name Seurat 'meta.data'. Default \"sample\". parameter called 'group..vars' Harmony. npcs Number principal components. dims.use Vector PCs use Harmony integration, e.g. 1:50. plot_dir Directory save generated plots. NULL, plots saved. n_hvgs Number highly variable genes (HVGs) compute, used input PCA. max.iter.harmony Maximum number iterations Harmony integration. seed Set random seed, reproducibility. fig.res Figure resolution ppi (see 'png' function). ... Additional named parameters passed RunHarmony Seurat processing functions, RunPCA ScaleData.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/harmony_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analysis steps for Harmony integration — harmony_analysis","text":"Updated Seurat object integrated processed data.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/harmony_analysis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Analysis steps for Harmony integration — harmony_analysis","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/heatmap_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored heatmap plot — heatmap_plot","title":"Tailored heatmap plot — heatmap_plot","text":"Heatmap plot showing marker genes clustering process. Expression levels taken scaled.data slot. Current implementation 'hard' coded: heatmap column annotation, assumes Seurat object contains 'condition', 'sample' 'seurat_clusters' columns meta.data slot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/heatmap_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored heatmap plot — heatmap_plot","text":"","code":"heatmap_plot(   seu,   markers,   topn_genes = 10,   diff_cluster_pct = 0.1,   pval_adj = 0.05,   filename = NULL,   col_pal = NULL,   heatmap_downsample_cols = NULL,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/heatmap_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored heatmap plot — heatmap_plot","text":"seu Seurat object (required). markers Data frame marker genes cluster. Expects format output Seurat's FindAllMarkers. topn_genes Top N marker genes plot cluster. diff_cluster_pct Retain marker genes per cluster pct.1 - pct.2 > diff_cluster_pct, .e. show cluster specific expression. Set -Inf, ignore additional filtering. pval_adj Adjusted p-value threshold consider marker genes per cluster. filename Filename saving heatmap plot. null, heatmap just plotted device. col_pal Discrete colour palette use, default Hue palette (hue_pal) 'scales' package. heatmap_downsample_cols numberic, downsamples columns heatmap plot, big specific cluster dominate heatmap. ... Additional parameters passed 'pheatmap' function","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/heatmap_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored heatmap plot — heatmap_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/heatmap_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored heatmap plot — heatmap_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/install_scrublet.html","id":null,"dir":"Reference","previous_headings":"","what":"Install Scrublet Python Package — install_scrublet","title":"Install Scrublet Python Package — install_scrublet","text":"Install Scrublet Python package virtualenv conda env.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/install_scrublet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Install Scrublet Python Package — install_scrublet","text":"","code":"install_scrublet(   envname = \"r-reticulate\",   method = \"auto\",   conda = \"auto\",   pip = TRUE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/install_scrublet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Install Scrublet Python Package — install_scrublet","text":"envname Name environment install packages method Installation method. default, \"auto\" automatically finds method work local environment. Change default force specific installation method. Note \"virtualenv\" method available Windows. conda Path conda executable (\"auto\" find conda using PATH conventional install locations). pip Install pip, possible. ... Additional arguments passed conda_install() virtualenv_install().","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/install_scrublet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Install Scrublet Python Package — install_scrublet","text":"Linux OS X \"virtualenv\" method used default (\"conda\" used virtualenv available). Windows, \"conda\" method always used.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/lognormalize_and_pca.html","id":null,"dir":"Reference","previous_headings":"","what":"Log normalisation and PCA computation — lognormalize_and_pca","title":"Log normalisation and PCA computation — lognormalize_and_pca","text":"function wrapps default Seurat analysis 1. data normalisation, 2. identification HVGs, 3. scaling expression computing PCA. list Seurat objects provided performed element list.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/lognormalize_and_pca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log normalisation and PCA computation — lognormalize_and_pca","text":"","code":"lognormalize_and_pca(seu, npcs = NULL, n_hvgs = 3000, ...)  # S3 method for list lognormalize_and_pca(seu, npcs = NULL, n_hvgs = 3000, ...)  # S3 method for Seurat lognormalize_and_pca(seu, npcs = NULL, n_hvgs = 3000, ...)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/lognormalize_and_pca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log normalisation and PCA computation — lognormalize_and_pca","text":"seu Seurat object list Seurat objects(required). npcs Number Principal Components (PCs) compute. NULL, PCA analysis skipped. n_hvgs Number highly variable genes (HVGs) compute. HVGs used input PCA. ... Additional named parameters passed Seurat functions.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/lognormalize_and_pca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log normalisation and PCA computation — lognormalize_and_pca","text":"List processed Seurat objects. single sample, returns processed Seurat object instead list.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/lognormalize_and_pca.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Log normalisation and PCA computation — lognormalize_and_pca","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/module_score_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Module score analysis — module_score_analysis","title":"Module score analysis — module_score_analysis","text":"function takes group modules calculates module scores expression programs. addition, plot_dir NULL creates feature plots marker genes module score saved plot_dir directory.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/module_score_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Module score analysis — module_score_analysis","text":"","code":"module_score_analysis(   seu,   modules_group,   plot_dir = NULL,   reduction = \"umap\",   max.cutoff = \"q98\",   min.cutoff = NA,   legend.position = \"top\",   col_pal = NULL,   dims_plot = c(1, 2),   seed = 1,   pt.size = 1.4,   fig.res = 200,   alpha = c(0.1, 0.9),   pt.size.factor = 1.1,   spatial_col_pal = \"inferno\",   crop = FALSE,   plot_spatial_markers = FALSE,   spatial_legend_position = \"top\",   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/module_score_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Module score analysis — module_score_analysis","text":"seu Seurat object (required). modules_group Group modules (named list lists) storing features (e.g. genes) compute module score identified cluster. step can useful annotating different clusters saving dot plots group. Assumes already computed modules e.g. calling 'module_score_analysis' function. 'plot_dir' NULL, plots generated. plot_dir Directory save generated plots. NULL, plots saved. reduction dimensionality reduction use (required). max.cutoff Vector maximum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Vector minimum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). legend.position Position legend, default \"right\" (set \"none\" clean plot). col_pal Continuous colour palette use, default \"RdYlBu\". dims_plot Dimensions plot, must two-length numeric vector specifying x- y-dimensions. seed Set random seed, reproducibility. pt.size Adjust point size plotting. fig.res Figure resolution ppi (see 'png' function). alpha (Spatial) Controls opacity spots. Provide vector specifying min max range values (0 1). pt.size.factor (Spatial) Scale size spots. spatial_col_pal (Spatial) Continuous colour palette use viridis package colour spots tissue, default \"inferno\". crop (Spatial) Crop plot focus spots passed QC. Set FALSE show entire background image. plot_spatial_markers (Spatial) Logical, whether create spatial feature plots expression individual genes. spatial_legend_position (Spatial) Position legend spatial plots, default \"top\" (set \"none\" clean plot). ... Additional named parameters passed Seurat's AddModuleScore FeaturePlot","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/module_score_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Module score analysis — module_score_analysis","text":"Updated Seurat object calculated module scores metadata.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/module_score_analysis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Module score analysis — module_score_analysis","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/pca_feature_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"PCA and feature metadata correlation heatmap plot — pca_feature_cor_plot","title":"PCA and feature metadata correlation heatmap plot — pca_feature_cor_plot","text":"function computes correlation principal components specific feature metadata (e.g. nFeature) identify potential technical/batch effects data.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/pca_feature_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PCA and feature metadata correlation heatmap plot — pca_feature_cor_plot","text":"","code":"pca_feature_cor_plot(seu, features)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/pca_feature_cor_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PCA and feature metadata correlation heatmap plot — pca_feature_cor_plot","text":"seu Seurat object (required). features Vector features metadata plot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/pca_feature_cor_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PCA and feature metadata correlation heatmap plot — pca_feature_cor_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/pca_feature_cor_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"PCA and feature metadata correlation heatmap plot — pca_feature_cor_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/qc_filter_seurat_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Seurat object based on QC metrics. — qc_filter_seurat_object","title":"Filter Seurat object based on QC metrics. — qc_filter_seurat_object","text":"function filters Seurat object (.e. removes cells) based QC metric thresholds. now based nFeatures mitochondrial percentage.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/qc_filter_seurat_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Seurat object based on QC metrics. — qc_filter_seurat_object","text":"","code":"qc_filter_seurat_object(seu, nfeat_thresh, mito_thresh)  # S3 method for list qc_filter_seurat_object(seu, nfeat_thresh, mito_thresh)  # S3 method for Seurat qc_filter_seurat_object(seu, nfeat_thresh, mito_thresh)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/qc_filter_seurat_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Seurat object based on QC metrics. — qc_filter_seurat_object","text":"seu Seurat object list Seurat objects(required). nfeat_thresh Filter cells less 'nfeat_thresh' counts expressed. mito_thresh Filter cells 'mito_thresh'% counts.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/qc_filter_seurat_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Seurat object based on QC metrics. — qc_filter_seurat_object","text":"List QC filtered Seurat objects. single sample, returns QC filtered Seurat object instead list.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/qc_filter_seurat_object.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Filter Seurat object based on QC metrics. — qc_filter_seurat_object","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_cluster_pipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipeline for clustering analysis — run_cluster_pipeline","title":"Pipeline for clustering analysis — run_cluster_pipeline","text":"function wraps common Seurat analysis pipeline cell type identification. include: 1. data processing, e.g. normalisation. 2. Running PCA. 3. Perform UMAP clustering. Analysis outputs stored corresponding directories. Note pipeline requires single Seurat object/sample.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_cluster_pipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipeline for clustering analysis — run_cluster_pipeline","text":"","code":"run_cluster_pipeline(   seu_obj,   out_dir,   npcs = c(50),   ndims = c(30),   res = seq(0.1, 0.3, by = 0.1),   modules_group = NULL,   metadata_to_plot = c(\"sample\", \"condition\"),   qc_to_plot = NULL,   logfc.threshold = 0.5,   min.pct = 0.25,   only.pos = TRUE,   topn_genes = 10,   diff_cluster_pct = 0.1,   pval_adj = 0.05,   pcs_to_remove = NULL,   plot_cluster_markers = TRUE,   max.cutoff = \"q98\",   min.cutoff = NA,   n_hvgs = 3000,   seed = 1,   label = TRUE,   label.size = 8,   pt.size = 1.4,   fig.res = 200,   cont_col_pal = NULL,   discrete_col_pal = NULL,   cont_alpha = c(0.1, 0.9),   discrete_alpha = 0.9,   pt.size.factor = 1.1,   spatial_col_pal = \"inferno\",   crop = FALSE,   plot_spatial_markers = FALSE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_cluster_pipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipeline for clustering analysis — run_cluster_pipeline","text":"seu_obj Seurat object (required). out_dir Output directory storing analysis results. npcs Number principal components, can vector e.g. c(50, 70). ndims Top PCA dimensions perform UMAP clustering, can vector e.g. c(50, 70). res Vector clustering resolutions (e.g. seq(0.1, 0.6, = 0.1)). modules_group Group modules (named list lists) storing features (e.g. genes) compute module score identified cluster. step can useful annotating different clusters saving dot/feature plots group. metadata_to_plot Vector metadata names plot, present meta.data slot Seurat object. qc_to_plot Vector QC names plot, present meta.data slot Seurat object. logfc.threshold Limit testing genes show, average, least X-fold difference (log-scale) two groups cells. min.pct test genes detected minimum fraction min.pct cells either two populations. .pos return positive markers (TRUE default). topn_genes Top cluster marker genes use plotting (heatmap feature plots), default 10. diff_cluster_pct Retain marker genes per cluster pct.1 - pct.2 > diff_cluster_pct, .e. show cluster specific expression. Set -Inf, ignore additional filtering. pval_adj Adjusted p-value threshold consider marker genes per cluster. pcs_to_remove PCs removed prior performing clustering. Possibly due correlated technical/batch effects. NULL, PCs used. plot_cluster_markers Logical, wheather create feature plots 'topn_genes' cluster markers. Added mostly reduce number files (size) analysis folders. Default TRUE. max.cutoff Maximum cutoff values plotting continuous feature, e.g. gene expression levels. May specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Maximum cutoff values plotting continuous feature, e.g. gene expression levels. May specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). n_hvgs Number highly variable genes (HVGs) compute, used input PCA. seed Set random seed, reproducibility. label Whether label clusters 'plot_reduction' space. label.size Sets size labels. pt.size Adjust point size plotting. fig.res Figure resolution ppi (see 'png' function). cont_col_pal Continuous colour palette use, default \"RdYlBu\". discrete_col_pal Discrete colour palette use, default Hue palette (hue_pal) 'scales' package. cont_alpha (Spatial) Controls opacity spots. Provide vector specifying min max range values (0 1). discrete_alpha (Spatial) Controls opacity spots. Provide single alpha value. pt.size.factor (Spatial) Scale size spots. spatial_col_pal (Spatial) Continuous colour palette use viridis package colour spots tissue, default \"inferno\". crop (Spatial) Crop plot focus spots passed QC plotted. Set FALSE show entire background image. plot_spatial_markers (Spatial) Logical, whether create spatial feature plots expression individual genes. ... Additional named parameters passed Seurat functions.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_cluster_pipeline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipeline for clustering analysis — run_cluster_pipeline","text":"updated Seurat object. Note multiple npcs ndims given, last setting returned. analysis results also stored disk.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_cluster_pipeline.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Pipeline for clustering analysis — run_cluster_pipeline","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony.html","id":null,"dir":"Reference","previous_headings":"","what":"Local implementation of RunHarmony function — run_harmony","title":"Local implementation of RunHarmony function — run_harmony","text":"local implementation RunHarmony function (harmony package) solves bug 'dims.use' parameter ignored.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Local implementation of RunHarmony function — run_harmony","text":"","code":"run_harmony(   object,   group.by.vars,   reduction = \"pca\",   dims.use = NULL,   theta = NULL,   lambda = NULL,   sigma = 0.1,   nclust = NULL,   tau = 0,   block.size = 0.05,   max.iter.harmony = 10,   max.iter.cluster = 20,   epsilon.cluster = 1e-05,   epsilon.harmony = 1e-04,   plot_convergence = FALSE,   verbose = TRUE,   reference_values = NULL,   reduction.save = \"harmony\",   assay.use = NULL,   project.dim = TRUE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Local implementation of RunHarmony function — run_harmony","text":"object Seurat object. group..vars variable(s) remove (character vector). reduction Dimensionality reduction use. dims.use PCA dimensions use Harmony. default, use theta Diversity clustering penalty parameter. Specify variable group..vars. Default theta=2. theta=0 encourage diversity. Larger values theta result diverse clusters. lambda Ridge regression penalty parameter. Specify variable group..vars. Default lambda=1. Lambda must strictly positive. Smaller values result aggressive correction. sigma Width soft kmeans clusters. Default sigma=0.1. Sigma scales distance cell cluster centroids. Larger values sigma result cells assigned clusters. Smaller values sigma make soft kmeans cluster approach hard clustering. nclust Number clusters model. nclust=1 equivalent simple linear regression. tau Protection overclustering small datasets large ones. tau expected number cells per cluster. block.size proportion cells update clustering. 0 1, default 0.05. Larger values may faster less accurate max.iter.harmony Maximum number rounds run Harmony. One round Harmony involves one clustering one correction step. max.iter.cluster Maximum number rounds run clustering round Harmony. epsilon.cluster Convergence tolerance clustering round Harmony Set -Inf never stop early. epsilon.harmony Convergence tolerance Harmony. Set -Inf never stop early. plot_convergence Whether print convergence plot clustering objective function. TRUE plot, FALSE suppress. can useful debugging. verbose Whether print progress messages. TRUE print, FALSE suppress. reference_values (Advanced Usage) Defines reference dataset(s). Cells batch variables values matching reference_values moved reduction.save Keyword save Harmony reduction. Useful want try Harmony multiple parameters save e.g. 'harmony_theta0', 'harmony_theta1', 'harmony_theta2' assay.use (Seurat V3 ) assay Harmonize (Default Assay default). project.dim Project dimension reduction loadings. Default TRUE. ... parameters","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Local implementation of RunHarmony function — run_harmony","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony_pipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipeline for Harmony integration — run_harmony_pipeline","title":"Pipeline for Harmony integration — run_harmony_pipeline","text":"function implements analysis steps perfoming data integration using Harmony. include: 1. data processing, e.g. normalisation, PCA. 2. Running Harmony 3. Perform UMAP clustering data integration. Analysis outputs stored corresponding directories.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony_pipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipeline for Harmony integration — run_harmony_pipeline","text":"","code":"run_harmony_pipeline(   seu_obj,   out_dir,   batch_id = \"sample\",   npcs = c(50),   ndims = c(30),   res = seq(0.1, 0.3, by = 0.1),   modules_group = NULL,   metadata_to_plot = c(\"sample\", \"condition\"),   qc_to_plot = NULL,   logfc.threshold = 0.5,   min.pct = 0.25,   only.pos = TRUE,   topn_genes = 10,   diff_cluster_pct = 0.1,   pval_adj = 0.05,   pcs_to_remove = NULL,   obj_filename = \"seu_harmony\",   force_reanalysis = TRUE,   plot_cluster_markers = TRUE,   max.cutoff = \"q98\",   min.cutoff = NA,   n_hvgs = 3000,   max.iter.harmony = 50,   seed = 1,   label = TRUE,   label.size = 8,   pt.size = 1.4,   fig.res = 200,   cont_col_pal = NULL,   discrete_col_pal = NULL,   cont_alpha = c(0.1, 0.9),   discrete_alpha = 0.9,   pt.size.factor = 1.1,   spatial_col_pal = \"inferno\",   crop = FALSE,   plot_spatial_markers = FALSE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony_pipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipeline for Harmony integration — run_harmony_pipeline","text":"seu_obj Seurat object list Seurat objects(required). out_dir Output directory storing analysis results. batch_id Name batch try remove data integration (required). Can also vector multiple batch information present. column name Seurat 'meta.data'. Default \"sample\". parameter called 'group..vars' Harmony. npcs Number principal components, can vector e.g. c(50, 70). ndims Top Harmony dimensions perform UMAP clustering, can vector e.g. c(50, 70). res Vector clustering resolutions (e.g. seq(0.1, 0.6, = 0.1)). modules_group Group modules (named list lists) storing features (e.g. genes) compute module score identified cluster. step can useful annotating different clusters saving dot/feature plots group. metadata_to_plot Vector metadata names plot, present meta.data slot Seurat object. qc_to_plot Vector QC names plot, present meta.data slot Seurat object. logfc.threshold Limit testing genes show, average, least X-fold difference (log-scale) two groups cells. min.pct test genes detected minimum fraction min.pct cells either two populations. .pos return positive markers (TRUE default). topn_genes Top cluster marker genes use plotting (heatmap feature plots), default 10. diff_cluster_pct Retain marker genes per cluster pct.1 - pct.2 > diff_cluster_pct, .e. show cluster specific expression. Set -Inf, ignore additional filtering. pval_adj Adjusted p-value threshold consider marker genes per cluster. pcs_to_remove PCs removed prior running Harmony. Possibly due correlated technical/batch effects. NULL, PCs used. obj_filename Filename stored Seurat object, default 'seu_harmony'. Number PCs added filename automatically. force_reanalysis Logical, intermediate object 'seu_harmony_<>.rds' exists force_reanalysis = FALSE, read object instead re-running Harmony integration. Added computing time efficiency purposes. plot_cluster_markers Logical, wheather create feature plots 'topn_genes' cluster markers. Added mostly reduce number files (size) analysis folders. Default TRUE. max.cutoff Maximum cutoff values plotting continuous feature, e.g. gene expression levels. May specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Maximum cutoff values plotting continuous feature, e.g. gene expression levels. May specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). n_hvgs Number highly variable genes (HVGs) compute, used input PCA. max.iter.harmony Maximum number iterations Harmony integration. seed Set random seed, reproducibility. label Whether label clusters 'plot_reduction' space. label.size Sets size labels. pt.size Adjust point size plotting. fig.res Figure resolution ppi (see 'png' function). cont_col_pal Continuous colour palette use, default \"RdYlBu\". discrete_col_pal Discrete colour palette use, default Hue palette (hue_pal) 'scales' package. cont_alpha (Spatial) Controls opacity spots. Provide vector specifying min max range values (0 1). discrete_alpha (Spatial) Controls opacity spots. Provide single alpha value. pt.size.factor (Spatial) Scale size spots. spatial_col_pal (Spatial) Continuous colour palette use viridis package colour spots tissue, default \"inferno\". crop (Spatial) Crop plot focus spots passed QC plotted. Set FALSE show entire background image. plot_spatial_markers (Spatial) Logical, whether create spatial feature plots expression individual genes. ... Additional named parameters passed Seurat's Harmony functions.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony_pipeline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipeline for Harmony integration — run_harmony_pipeline","text":"updated Seurat object. Note multiple npcs ndims given, last setting returned. analysis results also stored disk.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_harmony_pipeline.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Pipeline for Harmony integration — run_harmony_pipeline","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_qc_pipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"QC pipeline — run_qc_pipeline","title":"QC pipeline — run_qc_pipeline","text":"function implements analysis steps perfoming QC. include: 1. reading sample information metadata object/file generating one Seurat object per sample. 2. Performs SoupX (ambient RNA removal) Scrublet (doublet detection) user defines corresponding parameters. 3. Filter Seurat object according QC criteria 4. Generate correspond QC plots.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_qc_pipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"QC pipeline — run_qc_pipeline","text":"","code":"run_qc_pipeline(   data_dir,   sample_meta,   sample_meta_filename = NULL,   nfeat_thresh = 500,   mito_thresh = 5,   meta_colnames = c(\"donor\", \"condition\", \"pass_qc\"),   out_dir = NULL,   qc_to_plot = c(\"nFeature_RNA\", \"nCount_RNA\", \"percent.mito\"),   use_scrublet = TRUE,   use_soupx = FALSE,   tenx_dir = \"premrna_outs\",   tenx_counts_dir = \"filtered_feature_bc_matrix\",   obj_filename = \"seu_qc\",   expected_doublet_rate = 0.06,   force_reanalysis = TRUE,   min.cells = 10,   min.features = 100,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_qc_pipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"QC pipeline — run_qc_pipeline","text":"data_dir Parent directory sample 10x files stored. Think project directory. sample_meta Sample metadata information Data.frame like object. Columns least contain 'sample', 'donor', 'condition' 'pass_qc'. sample_meta_filename Filename sample metadata information, 'meta' parameter . User provide one 'meta' 'meta_filename'. nfeat_thresh Filter cells less 'nfeat_thresh' counts expressed. mito_thresh Filter cells 'mito_thresh'% counts. meta_colnames Sample metadata column names store Seurat metadata. out_dir Output directory storing analysis results. qc_to_plot Vector features metadata plot. use_scrublet Logical, wether use Scrublet doublet detection. use_soupx Logical, wether use SoupX ambient RNA removal. tenx_dir Name 10x base directory, e.g. outputs running cellranger. Default 'premrna_outs', .e. assumes single-nuclei RNA-seq. tenx_counts_dir Name 10x directory count matrices stored. Default 'filtered_feature_bc_matrix' obj_filename Filename stored Seurat object, default 'seu_qc'. expected_doublet_rate expected fraction transcriptomes doublets, typically 0.05 - 0.1 force_reanalysis Logical, intermediate file 'seu_preqc.rds' (created Seurat object) exists force_reanalysis = FALSE, read object instead re-running whole analysis soupX. Added computing time efficiency purposes intermediate object created 'use_soupx = TRUE'. min.cells Include features/genes detected least many cells. min.features Include cells least many features/genes detected. ... Additional named parameters passed Seurat, Scrublet SoupX.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_qc_pipeline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"QC pipeline — run_qc_pipeline","text":"List Seurat objects length number samples sample metadata file. single sample, return Seurat object instead list.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_qc_pipeline.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"QC pipeline — run_qc_pipeline","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_spatial_qc_pipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial QC pipeline — run_spatial_qc_pipeline","title":"Spatial QC pipeline — run_spatial_qc_pipeline","text":"function implements analysis steps perfoming QC. include: 1. reading sample information metadata object/file generating one Seurat object per sample. 2. Performs SoupX (ambient RNA removal) Scrublet (doublet detection) user defines corresponding parameters. 3. Filter Seurat object according QC criteria 4. Generate correspond QC plots.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_spatial_qc_pipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial QC pipeline — run_spatial_qc_pipeline","text":"","code":"run_spatial_qc_pipeline(   data_dir,   sample_meta,   sample_meta_filename = NULL,   nfeat_thresh = 500,   mito_thresh = 5,   meta_colnames = c(\"donor\", \"condition\", \"pass_qc\"),   out_dir = NULL,   qc_to_plot = c(\"nFeature_Spatial\", \"nCount_Spatial\", \"percent.mito\"),   alpha = c(0.1, 0.9),   pt.size.factor = 1.1,   max.cutoff = \"q98\",   min.cutoff = NA,   spatial_col_pal = \"inferno\",   crop = FALSE,   tenx_dir = \"outs\",   obj_filename = \"seu_qc\",   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_spatial_qc_pipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial QC pipeline — run_spatial_qc_pipeline","text":"data_dir Parent directory sample 10x files stored. Think project directory. sample_meta Sample metadata information Data.frame like object. Columns least contain 'sample', 'donor', 'condition' 'pass_qc'. sample_meta_filename Filename sample metadata information, 'meta' parameter . User provide one 'meta' 'meta_filename'. nfeat_thresh Filter cells less 'nfeat_thresh' counts expressed. mito_thresh Filter cells 'mito_thresh'% counts. meta_colnames Sample metadata column names store Seurat metadata. out_dir Output directory storing analysis results. qc_to_plot Vector features metadata plot. alpha Controls opacity spots. Provide vector specifying min max range values (0 1). pt.size.factor Scale size spots. max.cutoff Vector maximum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Vector minimum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). spatial_col_pal (Spatial) Continuous colour palette use viridis package colour spots tissue, default \"inferno\". crop (Spatial) Crop plot focus points plotted. Set FALSE show entire background image. tenx_dir Name 10x base directory, e.g. outputs running cellranger. Default 'premrna_outs', .e. assumes single-nuclei RNA-seq. obj_filename Filename stored Seurat object, default 'seu_qc'. ... Additional named parameters passed Seurat, Scrublet SoupX.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_spatial_qc_pipeline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial QC pipeline — run_spatial_qc_pipeline","text":"List Seurat objects length number samples sample metadata file. single sample, return Seurat object instead list.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_spatial_qc_pipeline.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Spatial QC pipeline — run_spatial_qc_pipeline","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_umap.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored UMAP function — run_umap","title":"Tailored UMAP function — run_umap","text":"function adapts Seurat RunUMAP function also checking 'dims' larger dimensions 'reduction' object. yes, uses maximum columns 'reduction' object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_umap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored UMAP function — run_umap","text":"","code":"run_umap(seu, dims, reduction, seed = 1, ...)"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_umap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored UMAP function — run_umap","text":"seu Seurat object (required). dims Vector denoting dimensions use input features, e.g. dims = 1:30 reduction Reduction object run UMAP. E.g. can 'pca' 'harmony' integrated data (required). seed Set random seed, reproducibility. ... Additional named parameters passed Seurat RunUMAP function.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_umap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored UMAP function — run_umap","text":"Seurat object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/run_umap.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored UMAP function — run_umap","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/scatter_meta_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored scatter plot of metadata — scatter_meta_plot","title":"Tailored scatter plot of metadata — scatter_meta_plot","text":"function creates scatter plot assess feature feature relationships","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/scatter_meta_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored scatter plot of metadata — scatter_meta_plot","text":"","code":"scatter_meta_plot(   seu,   features = c(\"nFeature_RNA\", \"nCount_RNA\", \"percent.mito\"),   pt.size = 1.2 )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/scatter_meta_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored scatter plot of metadata — scatter_meta_plot","text":"seu Seurat object (required). features Vector features metadata plot. pt.size Point size.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/scatter_meta_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored scatter plot of metadata — scatter_meta_plot","text":"ggplot2 list combinations elements features","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/scatter_meta_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored scatter plot of metadata — scatter_meta_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_create_seurat_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Seurat object based on spatial sample metadata. — spatial_create_seurat_object","title":"Create Seurat object based on spatial sample metadata. — spatial_create_seurat_object","text":"function creates Seurat object spatial (e.g. Visium) sample metadata file.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_create_seurat_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Seurat object based on spatial sample metadata. — spatial_create_seurat_object","text":"","code":"spatial_create_seurat_object(   data_dir,   sample_meta = NULL,   sample_meta_filename = NULL,   meta_colnames = c(\"donor\", \"condition\", \"pass_qc\"),   tenx_dir = \"outs\",   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_create_seurat_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Seurat object based on spatial sample metadata. — spatial_create_seurat_object","text":"data_dir Parent directory sample 10x files stored. Think project directory. sample_meta Sample metadata information Data.frame like object. Columns least contain 'sample', 'donor', 'condition' 'pass_qc'. sample_meta_filename Filename sample metadata information, 'meta' parameter . User provide one 'meta' 'meta_filename'. meta_colnames Sample metadata column names store Seurat metadata. tenx_dir Name 10x base directory, e.g. outputs running cellranger. Default 'premrna_outs', .e. assumes single-nuclei RNA-seq. ... Additional named parameters passed Seurat.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_create_seurat_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Seurat object based on spatial sample metadata. — spatial_create_seurat_object","text":"List Seurat objects equal number samples sample metadata file. single sample, returns Seurat object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_create_seurat_object.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create Seurat object based on spatial sample metadata. — spatial_create_seurat_object","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_dim_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored spatial dim plot — spatial_dim_plot","title":"Tailored spatial dim plot — spatial_dim_plot","text":"function adapts SpatialDimPlot Seurat function providing additional plotting options.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_dim_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored spatial dim plot — spatial_dim_plot","text":"","code":"spatial_dim_plot(   seu,   group.by = \"active.ident\",   title = NULL,   alpha = 0.6,   pt.size.factor = 1.1,   crop = FALSE,   col_pal = NULL,   legend.position = \"top\",   combine = TRUE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_dim_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored spatial dim plot — spatial_dim_plot","text":"seu Seurat object (required). group.Name meta.data column group data . title Plot title alpha Controls opacity spots. Provide single alpha value plot. pt.size.factor Scale size spots. crop Crop plot focus points plotted. Set FALSE show entire background image. col_pal Discrete colour palette use, default Hue palette (hue_pal) 'scales' package. equal length number groups 'group.'. legend.position Position legend, default \"right\" (set \"none\" clean plot). combine Combine plots single patchworked ggplot object. FALSE, return list ggplot objects ... Additional parameters passed Seurat's SpatialDimPlot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_dim_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored spatial dim plot — spatial_dim_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_dim_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored spatial dim plot — spatial_dim_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_feature_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Tailored spatial feature plot — spatial_feature_plot","title":"Tailored spatial feature plot — spatial_feature_plot","text":"function adapts SpatialFeaturePlot Seurat function providing additional plotting options.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_feature_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tailored spatial feature plot — spatial_feature_plot","text":"","code":"spatial_feature_plot(   seu,   features = \"nFeature_Spatial\",   title = NULL,   alpha = c(0.1, 0.9),   pt.size.factor = 1.1,   ncol = NULL,   max.cutoff = \"q98\",   min.cutoff = NA,   crop = FALSE,   col_pal = \"inferno\",   legend.position = \"top\",   combine = TRUE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_feature_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tailored spatial feature plot — spatial_feature_plot","text":"seu Seurat object (required). features Vector features plot. title Plot title alpha Controls opacity spots. Provide vector specifying min max range values (0 1). pt.size.factor Scale size spots. ncol Number columns display multiple features. max.cutoff Vector maximum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Vector minimum cutoff values feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). crop Crop plot focus points plotted. Set FALSE show entire background image. col_pal Continuous colour palette use viridis package, default \"inferno\". legend.position Position legend, default \"right\" (set \"none\" clean plot). combine Combine plots single patchworked ggplot object. FALSE, return list ggplot objects ... Additional parameters passed Seurat's SpatialFeaturePlot.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_feature_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tailored spatial feature plot — spatial_feature_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/spatial_feature_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tailored spatial feature plot — spatial_feature_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_dim_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset dim plot — subset_dim_plot","title":"Subset dim plot — subset_dim_plot","text":"function splits dim plots according grouping variable defined subset.. main difference whole dataset also shown background smaller points.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_dim_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset dim plot — subset_dim_plot","text":"","code":"subset_dim_plot(   seu,   subset.by,   reduction = \"umap\",   ncol = NULL,   col_pal = NULL,   pt.size = 2,   pt.stroke = 0.05,   pt.shape = 21,   pt.alpha = 1,   back.pt.size = 0.5,   back.pt.alpha = 0.1,   back.pt.color = \"grey\",   combine = TRUE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_dim_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset dim plot — subset_dim_plot","text":"seu Seurat object subset.Metadata column whose unique values generate split dim plots. reduction Dimensionality reduction use. ncol Number columns display multiple features. col_pal Discrete colour palette use. pt.size Adjust point size plotting. pt.stroke Stroke value point. pt.shape Adjust point shape plotting. pt.alpha Adjust alpha value point. back.pt.size Adjust background point size plotting. back.pt.alpha Adjust opacity background points. back.pt.color Colour background points. combine Combine plots single patchworked ggplot object. FALSE, return list ggplot objects ... Additional parameters passed ggplot2::geom_point.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_dim_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset dim plot — subset_dim_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_dim_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Subset dim plot — subset_dim_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_feature_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset feature plot — subset_feature_plot","title":"Subset feature plot — subset_feature_plot","text":"function splits feature plots according grouping variable defined subset.. main difference whole dataset also shown background smaller points.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_feature_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset feature plot — subset_feature_plot","text":"","code":"subset_feature_plot(   seu,   subset.by,   feature,   max.cutoff = \"q98\",   min.cutoff = NA,   reduction = \"umap\",   slot = \"data\",   ncol = NULL,   col_pal = NULL,   legend.position = \"right\",   pt.size = 2,   pt.stroke = 0.05,   pt.shape = 21,   pt.alpha = 1,   back.pt.size = 0.5,   back.pt.alpha = 0.1,   back.pt.color = \"grey\",   combine = TRUE,   order_points_by_value = TRUE,   ... )"},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_feature_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset feature plot — subset_feature_plot","text":"seu Seurat object subset.Metadata column whose unique values generate split feature plots. feature Feature plot. max.cutoff Maximum cutoff value feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). min.cutoff Minimum cutoff value feature, may specify quantile form 'q##' '##' quantile (eg, 'q1', 'q10'). reduction Dimensionality reduction use. slot Slot extract data . ncol Number columns display multiple features. col_pal Continuous colour palette use, default \"RdYlBu\". legend.position Position legend, default \"right\" (set \"none\" clean plot). pt.size Adjust point size plotting. pt.stroke Stroke value point. pt.shape Adjust point shape plotting. pt.alpha Adjust alpha value point. back.pt.size Adjust background point size plotting. back.pt.alpha Adjust opacity background points. back.pt.color Colour background points. combine Combine plots single patchworked ggplot object. FALSE, return list ggplot objects order_points_by_value Logical, points ordered value (e.g. expression levels), corresponds plotting top cells high expression, instead getting 'buried' lowly expressed cells. ... Additional parameters passed ggplot2::geom_point.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_feature_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset feature plot — subset_feature_plot","text":"ggplot2 object.","code":""},{"path":"https://andreaskapou.github.io/SeuratPipe/reference/subset_feature_plot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Subset feature plot — subset_feature_plot","text":"C..Kapourani C..Kapourani@ed.ac.uk","code":""}]
